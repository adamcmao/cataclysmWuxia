[
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_1000_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 1000" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_900_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 900" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_800_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 800" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_700_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 700" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_600_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 600" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_500_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 500" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_450_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 450" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_400_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 400" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_350_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 350" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_300_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 300" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_250_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 250" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_200_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 200" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_175_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 175" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_150_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 150" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_125_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 125" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_100_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 100" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_75_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 75" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_50_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 50" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_10_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 10" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_5_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 5" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_GAIN_1_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') += 1" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_1000_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 1000" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_900_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 900" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_800_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 800" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_700_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 700" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_600_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 600" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_500_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 500" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_450_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 450" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_400_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 400" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_350_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 350" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_300_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 300" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_250_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 250" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_200_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 200" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_175_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 175" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_150_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 150" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_125_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 125" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_100_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 100" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_75_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 75" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_50_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 50" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_10_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 10" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_5_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 5" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_1_QI",
    "eoc_type": "ACTIVATION",
    "effect": [ { "math": [ "u_vitamin('qi_vitamin') -= 1" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_MEDITATE_RESTORE_QI_START",
    "eoc_type": "ACTIVATION",
    "effect": [
      { "u_assign_activity": "ACT_MEDITATE_RESTORE_QI", "duration": "24 hours" },
      { "run_eocs": "EOC_MEDITATE_RESTORE_QI" },
      { "run_eocs": [ "EOC_MEDITATE_LEARN_SKILLS" ], "time_in_future": [ "5 minutes", "15 minutes" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_MEDITATE_LEARN_SKILLS",
    "effect": [
      { "run_eocs": [ "EOC_MEDITATE_LEARN_BEGGAR", "EOC_MEDITATE_LEARN_JIAN", "EOC_MEDITATE_LEARN_EMPTY" ] },
      { "run_eocs": [ "EOC_MEDITATE_LEARN_SKILLS" ], "time_in_future": [ "5 minutes", "15 minutes" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_MEDITATE_LEARN_BEGGAR",
    "condition": { "and": [ { "u_has_wielded_with_weapon_category": "QUARTERSTAVES" }, { "math": [ "rand(30) == 1" ] } ] },
    "effect": {
      "switch": { "math": [ "rand(5)" ] },
      "cases": [
        {
          "case": 0,
          "effect": {
            "if": { "math": [ "u_spell_level('dog_beating_staff_technique') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Dog Beating Staff Technique", "popup": true },
              { "math": [ "u_spell_level('dog_beating_staff_technique') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('dog_beating_staff_technique') += rand(1000)" ] }
          }
        },
        {
          "case": 1,
          "effect": {
            "if": { "math": [ "u_spell_level('staff_turns_beggar_firm') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Staff Turns Beggar Firm", "popup": true },
              { "math": [ "u_spell_level('staff_turns_beggar_firm') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('staff_turns_beggar_firm') += rand(1000)" ] }
          }
        },
        {
          "case": 2,
          "effect": {
            "if": { "math": [ "u_spell_level('pierce_the_alley') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Pierce The Alley", "popup": true },
              { "math": [ "u_spell_level('pierce_the_alley') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('pierce_the_alley') += rand(1000)" ] }
          }
        },
        {
          "case": 3,
          "effect": {
            "if": { "math": [ "u_spell_level('stick_snags_the_sleeve') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Stick Snags The Sleeve", "popup": true },
              { "math": [ "u_spell_level('stick_snags_the_sleeve') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('stick_snags_the_sleeve') += rand(1000)" ] }
          }
        },
        {
          "case": 4,
          "effect": {
            "if": { "math": [ "u_spell_level('hidden_alley_rat_tide') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Hidden Alley Rat Tide", "popup": true },
              { "math": [ "u_spell_level('hidden_alley_rat_tide') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('hidden_alley_rat_tide') += rand(1000)" ] }
          }
        }
      ]
    }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_MEDITATE_LEARN_JIAN",
    "condition": {
      "and": [
        {
          "or": [
            { "u_has_wielded_with_weapon_category": "MEDIUM_SWORDS" },
            { "u_has_wielded_with_weapon_category": "LONG_SWORDS" },
            { "u_has_wielded_with_weapon_category": "SHORT_SWORDS" },
            { "u_has_wielded_with_weapon_category": "LONG_THRUSTING_SWORDS" },
            { "u_has_wielded_with_weapon_category": "BIONIC_SWORDS" },
            { "u_has_wielded_with_weapon_category": "GREAT_SWORDS" }
          ]
        },
        { "math": [ "rand(30) == 1" ] }
      ]
    },
    "effect": {
      "switch": { "math": [ "rand(5)" ] },
      "cases": [
        {
          "case": 0,
          "effect": {
            "if": { "math": [ "u_spell_level('white_crane_spreads_its_wings') == -1" ] },
            "then": [
              { "message": "You learned a new technique - White Crane Spreads Its Wings", "popup": true },
              { "math": [ "u_spell_level('white_crane_spreads_its_wings') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('white_crane_spreads_its_wings') += rand(1000)" ] }
          }
        },
        {
          "case": 1,
          "effect": {
            "if": { "math": [ "u_spell_level('falling_star_scatters_the_flock') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Falling Star Scatters The Flock", "popup": true },
              { "math": [ "u_spell_level('falling_star_scatters_the_flock') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('falling_star_scatters_the_flock') += rand(1000)" ] }
          }
        },
        {
          "case": 2,
          "effect": {
            "if": { "math": [ "u_spell_level('still_water_breaks_the_blade') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Still Water Breaks The Blade", "popup": true },
              { "math": [ "u_spell_level('still_water_breaks_the_blade') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('still_water_breaks_the_blade') += rand(1000)" ] }
          }
        },
        {
          "case": 3,
          "effect": {
            "if": { "math": [ "u_spell_level('heavens_blink') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Heavens Blink", "popup": true },
              { "math": [ "u_spell_level('heavens_blink') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('heavens_blink') += rand(1000)" ] }
          }
        },
        {
          "case": 4,
          "effect": {
            "if": { "math": [ "u_spell_level('dripping_red_rain') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Dripping Red Rain", "popup": true },
              { "math": [ "u_spell_level('dripping_red_rain') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('dripping_red_rain') += rand(1000)" ] }
          }
        }
      ]
    }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_MEDITATE_LEARN_EMPTY",
    "condition": { "and": [ { "not": "u_has_weapon" }, { "math": [ "rand(30) == 1" ] } ] },
    "effect": {
      "switch": { "math": [ "rand(5)" ] },
      "cases": [
        {
          "case": 0,
          "effect": {
            "if": { "math": [ "u_spell_level('flowing_water_palm') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Flowing Water Palm", "popup": true },
              { "math": [ "u_spell_level('flowing_water_palm') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('flowing_water_palm') += rand(1000)" ] }
          }
        },
        {
          "case": 1,
          "effect": {
            "if": { "math": [ "u_spell_level('three_point_seal') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Three Point Seal", "popup": true },
              { "math": [ "u_spell_level('three_point_seal') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('three_point_seal') += rand(1000)" ] }
          }
        },
        {
          "case": 2,
          "effect": {
            "if": { "math": [ "u_spell_level('countering_still_hand') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Countering Still Hand", "popup": true },
              { "math": [ "u_spell_level('countering_still_hand') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('countering_still_hand') += rand(1000)" ] }
          }
        },
        {
          "case": 3,
          "effect": {
            "if": { "math": [ "u_spell_level('dragon_tail_strike') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Dragon Tail Strike", "popup": true },
              { "math": [ "u_spell_level('dragon_tail_strike') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('dragon_tail_strike') += rand(1000)" ] }
          }
        },
        {
          "case": 4,
          "effect": {
            "if": { "math": [ "u_spell_level('heaven_earth_mortal') == -1" ] },
            "then": [
              { "message": "You learned a new technique - Heaven Earth Mortal", "popup": true },
              { "math": [ "u_spell_level('heaven_earth_mortal') = 0" ] }
            ],
            "else": { "math": [ "u_spell_exp('heaven_earth_mortal') += rand(1000)" ] }
          }
        }
      ]
    }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_MEDITATE_RESTORE_QI",
    "eoc_type": "ACTIVATION",
    "effect": [
      { "math": [ "u_vitamin('qi_vitamin') += 5" ] },
      { "math": [ "u_pain() -= rand(1)" ] },
      {
        "if": { "math": [ "u_vitamin('qi_vitamin') >= 500" ] },
        "then": [
          {
            "switch": { "math": [ "rand(5)" ] },
            "cases": [
              { "case": 0, "effect": { "math": [ "u_hp('head') += rand(1)" ] } },
              { "case": 1, "effect": { "math": [ "u_hp('torso') += rand(1)" ] } },
              {
                "case": 2,
                "effect": {
                  "if": { "not": { "u_has_effect": "disabled", "bodypart": "arm_l" } },
                  "then": { "math": [ "u_hp('arm_l') += rand(1)" ] }
                }
              },
              {
                "case": 3,
                "effect": {
                  "if": { "not": { "u_has_effect": "disabled", "bodypart": "arm_r" } },
                  "then": { "math": [ "u_hp('arm_r') += rand(1)" ] }
                }
              },
              {
                "case": 4,
                "effect": {
                  "if": { "not": { "u_has_effect": "disabled", "bodypart": "leg_l" } },
                  "then": { "math": [ "u_hp('leg_l') += rand(1)" ] }
                }
              },
              {
                "case": 5,
                "effect": {
                  "if": { "not": { "u_has_effect": "disabled", "bodypart": "leg_r" } },
                  "then": { "math": [ "u_hp('leg_r') += rand(1)" ] }
                }
              }
            ]
          }
        ]
      },
      { "run_eocs": "EOC_MEDITATE_RESTORE_QI", "time_in_future": [ "1 minutes", "5 minutes" ] }
    ]
  },
  {
    "id": "ACT_MEDITATE_RESTORE_QI",
    "type": "activity_type",
    "activity_level": "LIGHT_EXERCISE",
    "verb": "meditating",
    "based_on": "time",
    "rooted": true
  }
]
