[
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_BLOOD_TINY",
    "effect": [ { "math": [ "u_blood_usage = 100" ] }, { "run_eocs": [ "EOC_USE_BLOOD_OR_GROUND" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_BLOOD_SMALL",
    "effect": [ { "math": [ "u_blood_usage = 1000" ] }, { "run_eocs": [ "EOC_USE_BLOOD_OR_GROUND" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_BLOOD_MEDIUM",
    "effect": [ { "math": [ "u_blood_usage = 3000" ] }, { "run_eocs": [ "EOC_USE_BLOOD_OR_GROUND" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_BLOOD_LARGE",
    "effect": [ { "math": [ "u_blood_usage = 5000" ] }, { "run_eocs": [ "EOC_USE_BLOOD_OR_GROUND" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_LOSE_BLOOD_HUGE",
    "effect": [ { "math": [ "u_blood_usage = 10000" ] }, { "run_eocs": [ "EOC_USE_BLOOD_OR_GROUND" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_USE_BLOOD_OR_GROUND",
    "effect": [
      {
        "store_coordinates_in": { "context_val": "bloody_ground" },
        "stop_at_first": true,
        "range": 1,
        "condition": { "and": [ { "map_field_id": "fd_blood", "loc": { "context_val": "bloody_ground" } } ] },
        "u_map_run_eocs": [
          {
            "id": "EOC_TEMP",
            "effect": [
              { "math": [ "u_blood_found = 1" ] },
              {
                "u_transform_radius": 0,
                "target_var": { "context_val": "bloody_ground" },
                "ter_furn_transform": "ter_remove_blood"
              }
            ]
          }
        ]
      },
      {
        "if": { "math": [ "u_blood_found == 0" ] },
        "then": [ { "math": [ "u_vitamin('blood') -= u_blood_usage" ] } ],
        "else": { "math": [ "u_blood_found = 0" ] }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_SPAWN_BLOOD_SWORD",
    "effect": {
      "switch": { "math": [ "u_spell_level('crimson_blood_sword')" ] },
      "cases": [
        { "case": 0, "effect": { "u_cast_spell": { "id": "spawn_crimson_blood_sword_actual" } } },
        { "case": 5, "effect": { "u_cast_spell": { "id": "spawn_crimson_blood_sword_actual2" } } },
        { "case": 10, "effect": { "u_cast_spell": { "id": "spawn_crimson_blood_sword_actual3" } } }
      ]
    }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_HEAVEN_DEVOURING_ART_START",
    "condition": {
      "or": [
        { "not": { "u_has_species": "JIANGSHI" } },
        { "not": { "u_has_species": "ZOMBIE" } },
        { "not": { "u_has_effect": "effect_qi_drained" } }
      ]
    },
    "effect": [
      { "u_location_variable": { "context_val": "loc" } },
      { "u_add_effect": "effect_qi_drained", "duration": "10 hours" },
      { "math": [ "n_vitamin('qi_vitamin') += (rand(n_spell_level('heaven_devouring_art')*5)+50)" ] },
      {
        "weighted_list_eocs": [ [ "EOC_HEAVEN_DEVOURING_ART_VISION", 1 ], [ "EOC_HEAVEN_DEVOURING_ART_HALLUCINATE", 1 ] ]
      }
    ],
    "false_effect": [ { "message": "Something is wrong, you are unable to drain qi from this victim.", "type": "mixed" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_HEAVEN_DEVOURING_ART_VISION",
    "condition": { "not": { "npc_has_effect": "visuals" } },
    "effect": [ { "message": "Your vision blurs", "type": "bad" }, { "npc_add_effect": "visuals", "duration": [ 15, 60 ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_HEAVEN_DEVOURING_ART_HALLUCINATE",
    "effect": [
      {
        "message": "As your absorb the energy, your fate is intertwined with your victim, and you see all timelines that could have been.",
        "type": "bad"
      },
      {
        "npc_spawn_monster": "",
        "hallucination_count": [ 10, 15 ],
        "target_range": 10,
        "max_radius": 10,
        "lifespan": [ "15 seconds", "1 minutes" ]
      }
    ]
  }
]
